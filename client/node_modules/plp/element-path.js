import req from 'plp/req';

const _ = req.all({
  extend: require('./extend'),
  parentNodes: require('./parent-nodes'),
});

function elementPath(elem, onlyTagNames = false) {
  var parents = _.parentNodes(elem, true);
  return parents
    .filter(e => e instanceof HTMLElement)
    .map(e => elementName(e, onlyTagNames))
    .reverse()
    .join(' > ');
}

function elementName(elem, onlyTagNames = false) {
  var exclude = [
    'ng-scope',
  ],
    cl = Array
      .from(elem.classList)
      .filter(name => !exclude.includes(name))
      .sort();
  return `${elem.tagName.toLowerCase()}`
    + (onlyTagNames ? '' : `${cl.length ? '.' : ''}${cl.join('.')}`);
}

_.extend(elementPath, {
  elementName,
});

export default elementPath;
