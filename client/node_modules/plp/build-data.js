'use strict';

const _ = {
  each: require('./each'),
  extend: require('./extend'),
};

function buildData (opts, index = {}, defaults = {}) {
  var result = {};
  _.each(index, (names, propName) => {
    _.each(names, name => {
      if (result[propName] !== undefined ||
        !opts.hasOwnProperty(name)) return;
      let val = opts[name],
        current = result[propName];
      if (current && typeof current === 'object' &&
        !Array.isArray(current))
        val = _.extend(current, val);
      result[propName] = val;
    });
  });
  return _.extend({}, defaults, result);
}

module.exports = buildData;
