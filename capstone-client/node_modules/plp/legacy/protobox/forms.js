import apply from './apply';

class CortElement extends HTMLElement {
  val (value) {
    var self = this;
    if (arguments.length === 1) {
      if (self.tagName === 'TEXTAREA') {
        self.html(value);
        return self;
      }
      if (self.type === 'checkbox') {
        self.checked = !!value;
        return;
      }
      self.value = value;
      return self;
    }
    if (self.tagName === 'TEXTAREA') {
      return self.html();
    }
    if (self.type === 'checkbox') {
      return !!self.checked;
    }
    return self.value;
  }

  formData (data) {
    var self = this,
      elem;
    if (arguments.length === 1) {
      self.many('[name]').forEach(elem => {
        var name = elem.getAttribute('name');
        if (!data.hasOwnProperty(name)) {
          return;
        }
        var value = data[name];
        if (elem.type === 'radio') {
          if (elem.val() === value) {
            elem.click();
          }
          return;
        }
        elem.val(value);
      });
      return;
    }
    data = {};
    Array.from(self.many('[name]')).forEach(elem => {
      var name = elem.attr('name');
      if (!name) {
        return;
      }
      if (elem.type === 'radio') {
        if (elem.checked) {
          data[name] = elem.val();
        }
        return;
      }
      data[name] = elem.val();
    });
    return data;
  }
}

apply(CortElement);

export default CortElement;
